# Workspace Notes

Mail Magic is a monorepo. Release notes are tracked per package:

- `packages/server/CHANGES`
- `packages/client/CHANGES`

This file captures workspace-level changes (tooling, repo layout, etc) and is not used for npm releases.

## 2026-02-19

- Extracted CLI code from `@technomoron/mail-magic-client` into a dedicated
  `packages/cli` workspace package with its own tests, build, and README.
- Workspace scripts now include `sync:shared`, `cli`, and `test:cli`; root
  `test` now runs CLI tests.
- Code clarity pass across the workspace: merge duplicate conditionals and
  replace `forEach` with `for...of` in `packages/common/template-preprocess.ts`;
  sync shared copies via `scripts/sync-shared-code.cjs`.

## 2026-02-08

- Reorganized docs: moved `packages/server/IDEAS.md` to `docs/IDEAS.md`, and moved package config examples/tutorial
  under `packages/server/docs/`.
- Rewrote `packages/server/README.md` to be a complete plain-language operator overview and to point readers to the
  Swagger/OpenAPI spec for the authoritative API contract.
- Added `docs/OVERVIEW.md` with a plain-language introduction to Mail Magic concepts and features.

## 2026-02-10

- Hardened inline asset (CID) handling and expanded test coverage to explicitly validate:
  inline assets, linked assets, and uploaded attachments across transactional and public form flows.

## 2026-02-07

- Documented new optional environment knobs in `.env-dist`, including
  `API_BASE_PATH`, `ASSET_PUBLIC_BASE`, `ADMIN_ENABLED`, and `ADMIN_APP_PATH`.
- Fixed asset caching headers by passing `maxAge` to Express `sendFile()`, and
  mounted the public asset handler under both `/asset/...` and `/api/asset/...`
  (when `API_BASE_PATH` is in use) to preserve existing expectations.
- Upgraded `@technomoron/api-server-base` to `2.0.0-beta.18` and adjusted
  `/api/...` custom route mounting to stay reachable with the new API 404
  handling.

## 2026-02-02

- Added a pnpm-aware workspace wrapper with npm fallback so root and package
  builds run under either package manager.
- Centralized pnpm build-script allowlist at the workspace root and documented
  pnpm-first development with npm for CI/publishing.
- Added a workspace-wide pnpm definition and type stubs to keep optional admin
  integration building without a hard dependency.
